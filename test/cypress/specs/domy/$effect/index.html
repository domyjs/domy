<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>$effect</title>
    <script src="/packages/domy/dist/index.js"></script>
  </head>
  <body>
    <h1 id="effectCall">0</h1>

    <Count d-if="show" :count="count"></Count>

    <span d-if="show">{{ show }}</span>

    <button id="inc" @click="++count">Increment</button>
    <button id="show" @click="show = !show">Show/Hide</button>
  </body>
  <script>
    const Count = DOMY.createComponent({
      props: ['count'],
      html: `
        <div>
          <p>{{ $props.count }}</p>
        </div>
      `,
      app: {
        mounted() {
          this.$effect(() => {
            console.log('Effect called', this.$props.count);
            const el = document.querySelector('#effectCall');
            el.textContent = Number(el.textContent) + 1;
          });
        },
        unmounted() {
          console.log('unmount');
        }
      }
    });

    DOMY.createApp({
      data() {
        return {
          show: false,
          count: 0
        };
      }
    })
      .components({
        Count
      })
      .mount();
  </script>
</html>
