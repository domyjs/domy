<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>d-for</title>
    <script src="/packages/domy/dist/index.js"></script>
  </head>
  <body>
    <ul d-for="user, index of list">
      Some text that shouldn't be rendered
      <li
        d-if="user.id"
        :key="user.id"
        @click="user.isClient = !user.isClient"
        :style="{ color: user.isClient ? 'blue' : 'red' }"
      >
        <p>
          {{index}}: Name {{ user.name }}, isClient: {{ user.isClient }} , Click on the cars to
          remove the first one
          <span style="display: none" d-ignore>{{ index }}</span>
        </p>
        <ul d-for="car, index of user.cars">
          <li class="cars" :key="car + index" @click="user.cars.shift()">
            <p>{{ index }}: {{ car }}</p>
          </li>
        </ul>
      </li>
      <!-- Some comment that shouldn't be rendered  -->
    </ul>
    <button id="add" @click="addElement()">Add</button>
    <button id="rm" @click="removeElement()">Remove</button>
  </body>
  <script>
    DOMY.createApp({
      setup() {
        this.list.push(this.generateElement());
      },
      data() {
        return {
          id: 0,
          list: []
        };
      },
      methods: {
        generateElement() {
          const newEl = {
            id: ++this.id,
            name: (Math.random() * 10000).toString(36),
            cars: ['BMW', 'PEUGEOT', 'MERCEDES'],
            isClient: true
          };
          return newEl;
        },
        addElement() {
          this.list.push(this.generateElement());
        },
        removeElement() {
          this.list.pop();
        }
      }
    }).mount();
  </script>
</html>
