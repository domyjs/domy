<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>d-for</title>
    <script src="..//dist/index.js"></script>
  </head>
  <body>
    <ul d-for="user, index of this.list">
      Some text that shouldn't be rendered
      <li
        :key="this.user.id"
        @click="this.user.isClient = !this.user.isClient"
        :style="{ color: this.user.isClient ? 'blue' : 'red' }"
      >
        <p>{{this.index}}: {{ this.user.name }} <span d-ignore>{{ this.index }}</span></p>
        <ul d-for="car, index of this.user.cars">
          <li :key="this.car + this.index" @click="this.user.cars.shift()">
            {{ this.index }}: {{ this.car }}
          </li>
        </ul>
      </li>
      <!-- Some comment that shouldn't be rendered  -->
    </ul>
    <button id="add" @click="this.addElement()">Add</button>
    <button id="rm" @click="this.removeElement()">Remove</button>
  </body>
  <script>
    DOMY.createApp({
      $setup() {
        this.list.push(this.generateElement());
        console.log(this.list, this.generateElement());
      },
      $state: {
        id: 0,
        list: []
      },
      $fn: {
        generateElement() {
          const newEl = {
            id: ++this.id,
            name: (Math.random() * 10000).toString(36),
            cars: ['BMW', 'PEUGEOT', 'MERCEDES'].filter(e => Math.random() > 0.5),
            isClient: true
          };
          return newEl;
        },
        addElement() {
          this.list.push(this.generateElement());
        },
        removeElement() {
          this.list.pop();
        }
      }
    });
  </script>
</html>
