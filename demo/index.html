<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DOMY | Demo for domy framework</title>
    <script src="../dist/index.js"></script>
  </head>
  <body>
    <div>
      <h1 d-text="this.search.value"></h1>
      <input type="text" d-model="search" />
    </div>

    <div d-ignore>
      <h1 d-text="this.search.value"></h1>
      <input type="text" d-model="search" />
    </div>

    <div>
      <div @notify="alert('User notified')"></div>
      <button @click="this.$dispatch('notify')">Notify</button>
    </div>

    <main>
      <h1 d-text="this.search.value"></h1>

      <h1>Count: {{ this.count.value }}</h1>

      <h2 d-html="new Date().getFullYear()" d-ref="year"></h2>

      <div
        :style="`width: 50px; height: 50px; background-color: ${this.count.value % 2 === 0 ? 'red' : 'yellow'}`"
      ></div>

      <button @click="this.activeSupperBtn.set(!this.activeSupperBtn.value)">
        Active supper btn
      </button>
      <button @click="this.incrementCount()">+</button>
      <button @click="this.count.set((old) => old - 1)">-</button>

      <button d-if="this.activeSupperBtn.value" d-on:click="this.count.set((old) => old + 10)">
        +10
      </button>
      <button d-if="this.activeSupperBtn.value" d-on:click="this.count.set((old) => old - 10)">
        -10
      </button>

      <ul d-if="this.count.value > 0" d-for="test, index of Array(this.count.value).fill('Click')">
        Message:
        <li d-text="this.test.value + ' ' + this.index.value"></li>
      </ul>

      <ul d-for="el of this.list.value">
        Message:
        <li d-text="this.el.value"></li>
      </ul>

      <button
        @click="this.list.set((old) => [...old, this.count.value]) && this.count.set((old) => old + 1)"
      >
        Add element
      </button>
      <button @click="this.list.set((old) => old.splice(1))  && this.count.set((old) => old - 1)">
        Remove element
      </button>
    </main>
  </body>
  <script>
    window.DOMY({
      $init() {
        console.log('Init', this.$refs, this.$el);
        this.displayThis();
      },
      $watch: {
        count() {
          this.displayThis();
          this.count.set(Math.max(this.count.value, 0));
        }
      },
      $state: {
        count: 0,
        activeSupperBtn: false,
        list: [],
        search: ''
      },
      $fn: {
        displayThisSupper() {
          console.log('This', this, this.$refs, this.$el);
        },
        displayThis() {
          this.displayThisSupper();
        },
        incrementCount() {
          this.displayThis();
          this.count.set(old => old + 1);
        }
      }
    });
  </script>
</html>
